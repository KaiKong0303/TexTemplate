% ===========================================================================
%           Wrap document environment with HSCDocument environment
% ===========================================================================

\AddToHook{env/HSCDocument/before}{
  % Register different entries: glossary, nomenclature, acronyms
  \makeglossaries
  %\include{Verzeichnisse/Worttrennungen}
  \input{lists/acronyms}  
  \makenomenclature
  \IfFileExists{./lists/symbols.tex}{\input{./lists/symbols.tex}}{}
  \IfFileExists{./lists/glossary.tex}{\input{lists/glossary.tex}}{}

  \begin{document}
}

\AddToHook{env/HSCDocument/after}{
  \end{document}
}

\AddToHook{cmd/section/before}{\clearpage}

\makeatletter
\define@key{HSCDocument@keys}{preset}{\def\DocumentType{#1}}
\makeatother

\newenvironment{HSCDocument}[1][]{

  \makeatletter
  \setkeys{HSCDocument@keys}{preset=Custom,#1}
  \makeatother

  % ===========================================================================
  %                             Document header
  % ===========================================================================  

  \newgeometry{
    left=2.5cm,
    right=2.5cm,
    top=2.5cm,
    bottom=2.5cm
  }

  \begin{titlepage}
    \ifthenelse{\equal{\DocumentType}{Praxisbericht}}
      {\input{template/header_practice_report.tex}}
      {
        \ifthenelse{\equal{\DocumentType}{Bachelorarbeit}}
          {\input{template/header}}
          {
            \ifthenelse{\equal{\DocumentType}{Masterarbeit}}
              {\input{template/header}}
              {
                %\IfFileExists{./CustomHeader.tex}
                %{
                  \input{CustomHeader}
                %}
                {
                  ERROR: Please use one of the following values as parameter
                  to the HSCdocument environment:\\
                  "Praxisbericht", "Bachelorarbeit", "Masterarbeit"\\

                  To create your own document header, just create a file
                  "CustomHeader.tex" in the document root.
                }
              }
          }
      }
  \end{titlepage}

  \restoregeometry

  % Header is considered the 1st page
  \addtocounter{page}{1}

  % Peripheral pages have to be numbered using roman numerals
  \pagenumbering{Roman}
  
  % ===========================================================================
  %                              Page Ordering
  % ===========================================================================

    
  % Optional notice to the reader ("Vermerk")
  \IfFileExists{./secs/Z0vermerk.tex}{    
    \thispagestyle{empty}
    \input{secs/Z0vermerk}
  }{}

   \IfFileExists{./secs/A0abstract.tex}{    
    \fancypagestyle{abstract}{
      \fancyhead[L]{Zusammenfassung}
    }
    \phantomsection
    \section*{Zusammenfassung}
    \thispagestyle{abstract}
    \input{./secs/A0abstract}
  }{}
  
  \tableofcontents

  % List of Figures
  \iftotalfigures    
    \phantomsection
    \addcontentsline{toc}{section}{\listfigurename}
    \listoffigures
  \fi

  % List of Tables
  \iftotaltables    
    \phantomsection
    \addcontentsline{toc}{section}{\listtablename}
    \listoftables
  \fi

  % List of Codes
  \iftotallstlistings
    \phantomsection
    \addcontentsline{toc}{section}{\lstlistlistingname}
    \lstlistoflistings
  \fi
  
  % List of Symbols
  \iftotalcountnomens    
    \phantomsection
    \addcontentsline{toc}{section}{\nomname}
    \printnomenclature[2.5cm]
  \fi
  
  % List of Acronyms
    \newpage    
    \setglossarystyle{super}
    \printglossary[type=\acronymtype]
 

  % Save page counter, used for consecutive numbering of peripherals following main content
  \newcounter{HSCPeripheralNumbering}
  \setcounter{HSCPeripheralNumbering}{\value{page}}

  % Set numbering of pages to arabic for main content
  \pagenumbering{arabic}
}
{
  % Reset numbering to use roman numerals for rest of peripheral files
  \pagenumbering{Roman}
  \setcounter{page}{\value{HSCPeripheralNumbering}}
  
  % Appendix
  \IfFileExists{./secs/D0appendix.tex}{    
    \appendix
    \renewcommand{\thesection}{A\arabic{section}}
    \input{secs/D0appendix}
  }{}

  % Bibliography
  \iftotalcountcitations    
    \phantomsection
    \renewcommand*{\refname}{\hscrefname}               % Bibliography
    \addcontentsline{toc}{section}{\refname}
  \else
    \renewcommand*{\refname}{}                                     % Bibliography
  \fi    
  \bibliographystyle{alphadin}
  \bibliography{common/bibliography}
  
  % Glossary
  \iftotalcountglossarys
    \setglossarystyle{altlist}
    \printglossary
  \fi

  \makedeclarationofhonor

  % TODO list
  \iftotalcounttodos
    \phantomsection
    \addcontentsline{toc}{section}{TODOs}
    \thispagestyle{empty}
    \listoftodos[TODOs]
  \fi
}

% ===========================================================================
%                   Simplified centered & colored tables
% ===========================================================================

\newenvironment{colortable}[1]{
  \begin{center}
    \begin{tabular}{#1}
    \hline
    \rowcolor{Gray}
}
{
    \hline
    \end{tabular}
  \end{center}
}

\newcommand{\tablecontent}{
  \hline
  \rowcolor{White}
}

